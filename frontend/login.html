<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>SellerGen AI – Login</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-100 flex items-center justify-center min-h-screen">

<div class="bg-white p-8 rounded-xl shadow-lg w-full max-w-md">
  <h2 class="text-2xl font-bold text-center text-blue-600 mb-6">SellerGen AI</h2>
  <p class="text-center text-slate-500 mb-6">Login to your account</p>

  <input id="email" type="email" placeholder="Email"
    class="w-full p-2 mb-3 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500">

  <input id="password" type="password" placeholder="Password"
    class="w-full p-2 mb-4 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500">

  <button onclick="loginUser()"
  class="w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700">
  Login
</button>

  <p class="text-center text-sm text-slate-500 mt-4">
    Don’t have an account?
    <a href="/signup" class="text-blue-600 font-semibold">Sign up</a>
  </p>
  <p class="text-center text-sm text-slate-500 mt-3">
  Forgot your password?
  <a href="/forgot-password" class="text-blue-600 font-semibold hover:underline">
    Reset here
  </a>
</p>
</div>

 <script>
async function loginUser() {

  const email = document.getElementById("email").value.trim();
  const password = document.getElementById("password").value.trim();

  // Empty validation
  if(email === "" || password === ""){
    alert("Email and password are required");
    return;
  }

  // Email format validation
  const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
  if(!emailRegex.test(email)){
    alert("Enter a valid email address");
    return;
  }

  // Password length validation
  if(password.length < 6){
    alert("Password must be at least 6 characters");
    return;
  }

  const data = {
    email: email,
    password: password
  };

  try{
    const res = await fetch("/login", {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify(data)
    });

    const result = await res.json();

    if (!res.ok) {
      alert(result.detail || "Login failed");
      return;
    }

    // Save login data
    localStorage.setItem("token", result.token);
    localStorage.setItem("plan", result.plan);
    localStorage.setItem("role", result.role);
    localStorage.setItem("email", email);

    // Role based redirect
    if(result.role === "admin"){
      window.location.href = "/admin";
    }else{
      window.location.href = "/dashboard";
    }

  }catch(error){
    alert("Server error. Please try again later.");
    console.error(error);
  }
}

</script>


</body>
</html>
